---
import { Separator } from '@/components/ui/separator';

const repo = import.meta.env.PUBLIC_GISCUS_REPO;
const repoId = import.meta.env.PUBLIC_GISCUS_REPO_ID;
const category = import.meta.env.PUBLIC_GISCUS_CATEGORY;
const categoryId = import.meta.env.PUBLIC_GISCUS_CATEGORY_ID;
const mapping = import.meta.env.PUBLIC_GISCUS_MAPPING ?? 'pathname';
const theme = import.meta.env.PUBLIC_GISCUS_THEME ?? 'preferred_color_scheme';
const lang = import.meta.env.PUBLIC_GISCUS_LANG ?? 'en';
const reactionsEnabled = import.meta.env.PUBLIC_GISCUS_REACTIONS ?? '1';
const emitMetadata = import.meta.env.PUBLIC_GISCUS_EMIT_METADATA ?? '0';
const inputPosition = import.meta.env.PUBLIC_GISCUS_INPUT_POSITION ?? 'bottom';
const strict = import.meta.env.PUBLIC_GISCUS_STRICT ?? '0';
const loading = import.meta.env.PUBLIC_GISCUS_LOADING ?? 'lazy';

const enabled = Boolean(repo && repoId && category && categoryId);
---

{enabled && (
	<>
		<Separator />
		<section class="space-y-4">
			<h2 class="text-2xl font-semibold text-foreground">Comments</h2>
			<div class="giscus"></div>
			<script
				is:inline
				src="https://giscus.app/client.js"
				data-repo={repo}
				data-repo-id={repoId}
				data-category={category}
				data-category-id={categoryId}
				data-mapping={mapping}
				data-strict={strict}
				data-reactions-enabled={reactionsEnabled}
				data-emit-metadata={emitMetadata}
				data-input-position={inputPosition}
				data-theme={theme}
				data-lang={lang}
				data-loading={loading}
				crossorigin="anonymous"
				async
			></script>
		</section>
	</>
)}
